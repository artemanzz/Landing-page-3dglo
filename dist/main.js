(()=>{"use strict";(()=>{const e=document.querySelectorAll("form"),t=document.createElement("div");t.style.cssText="font-size: 2rem;",e.forEach((e=>{e.append(t),e.addEventListener("submit",(n=>{n.preventDefault();let o=!1;if(e.querySelectorAll("input").forEach((e=>{""===e.value&&(o=!0)})),!o){e.append(t),t.innerHTML='\n      <div class="load-wrapp">\n        <div class="load-3">\n          <div class="line"></div>\n          <div class="line"></div>\n          <div class="line"></div>\n        </div>\n      </div>',"form3"===e.id&&(t.style.cssText+="color: #fff;");const n=new FormData(e),o={};n.forEach(((e,t)=>{o[t]=e})),((n,o,c,a)=>{const l=new XMLHttpRequest;l.addEventListener("readystatechange",(()=>{4===l.readyState&&(200===l.status?(t.textContent="Спасибо! Мы скоро с вами свяжемся.",setTimeout((()=>{t.innerHTML="","form3"===e.id&&(document.querySelector(".popup").style.display="none")}),3e3),e.querySelectorAll("input").forEach((e=>e.value=""))):(t.textContent="Что-то пошло не так...",setTimeout((()=>t.innerHTML=""),3e3)))})),l.open("POST","./server.php"),l.setRequestHeader("Content-Type","application/json"),l.send(JSON.stringify(n))})(o)}}))}))})(),function(e){const t=document.querySelector("#timer-hours"),n=document.querySelector("#timer-minutes"),o=document.querySelector("#timer-seconds"),c=new Date(e).getTime(),a=setInterval(l,1e3);function l(){const e=function(){const e=(new Date).getTime(),t=(c-e)/1e3,n=Math.floor(t%60),o=Math.floor(t/60%60);return{timeRemaining:t,hours:Math.floor(t/60/60),minutes:o,seconds:n}}();String(e.hours).length<2&&(e.hours="0"+e.hours),String(e.minutes).length<2&&(e.minutes="0"+e.minutes),String(e.seconds).length<2&&(e.seconds="0"+e.seconds),t.textContent=e.hours,n.textContent=e.minutes,o.textContent=e.seconds,(0===e.timeRemaining||e.timeRemaining<0)&&(t.textContent="00",n.textContent="00",o.textContent="00",clearInterval(a))}l()}("14 march 2021"),(()=>{const e=document.querySelector("body"),t=document.querySelector("menu"),n=document.querySelector('a[href="#service-block"]'),o=()=>{t.classList.toggle("active-menu")},c=(e,t)=>{e.preventDefault();const n=document.querySelector(t.hash).getBoundingClientRect().y;let o=0,c=0;const a=e=>{c=requestAnimationFrame((()=>a(e))),window.scrollBy(0,e),o+=e,o>=n&&cancelAnimationFrame(c)};switch(t.hash){case"#service-block":a(30);break;case"#portfolio":a(35);break;case"#calc":a(40);break;case"#command":a(45);break;case"#connect":a(50)}};e.addEventListener("click",(e=>{const a=e.target;let l;a.closest(".menu")||a.closest(".close-btn")?o():(l=a.closest(".active-menu ul li a"))?(o(),c(e,l)):!a.closest("menu")&&t.classList.contains("active-menu")?o():(l=a.closest('a[href="#service-block"]'))===n&&c(e,l)}))})(),(()=>{const e=document.querySelector(".popup"),t=e.querySelector(".popup-content"),n=document.querySelectorAll(".popup-btn"),o=function(){if(e.style.display="block",document.documentElement.clientWidth>=768){let e=0,n=-500;const o=document.documentElement.clientHeight/2;t.style.top=n+"px";const c=()=>{e=requestAnimationFrame(c),n+=50,t.style.top=n+"px",t.getBoundingClientRect().bottom>=o+120&&cancelAnimationFrame(e)};c()}};n.forEach((e=>{e.addEventListener("click",o)})),e.addEventListener("click",(t=>{let n=t.target;n.classList.contains("popup-close")?e.style.display="none":(n=n.closest(".popup-content"),n||(e.style.display="none"))}))})(),(()=>{const e=document.querySelector(".service-header"),t=e.querySelectorAll(".service-header-tab"),n=document.querySelectorAll(".service-tab");e.addEventListener("click",(e=>{let o=e.target;o=o.closest(".service-header-tab"),o&&t.forEach(((e,c)=>{e===o&&(e=>{for(let o=0;o<n.length;o++)e===o?(t[o].classList.add("active"),n[o].classList.remove("d-none")):(t[o].classList.remove("active"),n[o].classList.add("d-none"))})(c)}))}))})(),(()=>{const e=document.querySelector(".portfolio-content"),t=document.querySelectorAll(".portfolio-item");let n,o=0;(()=>{const t=e.querySelectorAll("li.portfolio-item").length,n=document.querySelector(".portfolio-dots");for(let e=0;e<t;e++){const t=document.createElement("li");t.classList.add("dot"),0===e&&t.classList.add("dot-active"),n.append(t)}})();const c=document.querySelectorAll(".dot"),a=(e,t,n)=>{e[t].classList.remove(n)},l=(e,t,n)=>{e[t].classList.add(n)},r=()=>{a(t,o,"portfolio-item-active"),a(c,o,"dot-active"),o++,o>=t.length&&(o=0),l(t,o,"portfolio-item-active"),l(c,o,"dot-active")},s=(e=3e3)=>n=setInterval(r,e);e.addEventListener("click",(e=>{e.preventDefault();const n=e.target;n.matches(".portfolio-btn, .dot")&&(a(t,o,"portfolio-item-active"),a(c,o,"dot-active"),n.matches("#arrow-right")?o++:n.matches("#arrow-left")?o--:n.matches(".dot")&&c.forEach(((e,t)=>{e===n&&(o=t)})),o>=t.length?o=0:o<0&&(o=t.length-1),l(t,o,"portfolio-item-active"),l(c,o,"dot-active"))})),e.addEventListener("mouseover",(e=>{(e.target.matches(".portfolio-btn")||e.target.matches(".dot"))&&clearInterval(n)})),e.addEventListener("mouseout",(e=>{(e.target.matches(".portfolio-btn")||e.target.matches(".dot"))&&s()})),s(3e3)})(),(()=>{const e=document.getElementById("command"),t={elem:"",originalSrc:""},n=e=>{const n=e.target;n.matches("img.command__photo")?t.elem||(t.elem=n,t.originalSrc=n.src,t.elem.src=t.elem.dataset.img):t.elem&&(t.elem.src=t.originalSrc,t.elem="",t.originalSrc="")};e.addEventListener("mouseover",n),e.addEventListener("mouseout",n)})(),((...e)=>{const t=document.querySelector(".calc-block"),n=e=>{const t=e.target;t.matches("input#form1-name, input#form2-name, input#form3-name, input#form2-message")&&(t.value=t.value.replace(/[^а-яё\s-]/gi,"")),t.matches("input#form1-email, input#form2-email, input#form3-email")&&(t.value=t.value.replace(/[^a-z@-_\.\!\~\*\']/gi,""),t.value=t.value.replace(/@.*@/g,(e=>e.substring(0,e.length-1))),t.value=t.value.replace(/@(.+)/g,((e,t)=>{let n="",o=0,c=3;for(let e=0;e<t.length;e++){if(/[a-z]/.test(t[e])&&!o&&(n+=t[e]),/\./.test(t[e])&&!o){if(""===n)return"";n+=t[e],o++}/[a-z]/.test(t[e])&&o&&c&&(n+=t[e],c--)}return"@"+n}))),t.matches("input#form1-phone, input#form2-phone, input#form3-phone")&&(t.value=t.value.replace(/[^\d-()\+]/g,""),t.value=t.value.replace(/(.+)/g,((e,t)=>{let n="8(___)___-__-__",o="",c="",a=0;for(/\+/.test(t[0])&&(c+="+",a++,n="+7"+n.substring(1,n.length));a<t.length;a++)a<n.length&&("8"===n[a]?o=/8/:"7"===n[a]?o=/7/:"_"===n[a]?o=/\d/:"("===n[a]?o=/[\d\(]/:")"===n[a]?o=/[\)]/:"-"===n[a]&&(o=/[\d-]/),o.test(t[a])&&(o.test("(")&&!/\(/.test(t[a])&&(n=n.split(/[\(\)]/),n=n.join("")),o.test("-")&&!/-/.test(t[a])&&(n=n.split(/-/),n=n.join("")),c+=t[a]));return c})))},o=e=>{const t=e.target;if(n(e),t.matches("input#form1-name, input#form2-name, input#form3-name")){const e=t.value.split(" ");e.forEach(((e,t,n)=>n[t]=e.replace(/^./,(e=>e.toUpperCase())))),t.value=e.join(" ")}t.value=t.value.replace(/ +/g," "),t.value=t.value.replace(/(\s*-\s*)+/g,"-"),t.value=t.value.replace(/(\s*@\s*)+/g,"@"),t.value=t.value.replace(/-\s?$/g,""),t.value=t.value.trim()};e&&e.forEach((e=>{e.addEventListener("input",n);for(const t in e)e.hasOwnProperty(t)&&"BUTTON"!==e[t].nodeName&&e[t].addEventListener("blur",o)})),t.addEventListener("input",(e=>{const t=e.target;t.matches("input.calc-item")&&(t.value=t.value.replace(/\D/,""))}))})(...document.querySelectorAll("form")),((e=100)=>{const t=document.querySelector(".calc-block"),n=document.querySelector(".calc-type"),o=document.querySelector(".calc-square"),c=document.querySelector(".calc-day"),a=document.querySelector(".calc-count"),l=document.getElementById("total");t.addEventListener("change",(t=>{const r=t.target;(r.matches("select")||r.matches("input"))&&(()=>{let t=0,r=1,s=1;const i=+n.options[n.selectedIndex].value,u=+o.value;a.value>1&&(r+=(a.value-1)/10),c.value&&c.value<5?s*=2:c.value&&c.value<10&&(s*=1.5),i&&u&&(t=e*i*u*r*s),(()=>{const e={start:null,total:1e3},n=o=>{e.start||(e.start=o);const c=Math.min((o-e.start)/e.total,1),a=c*t;l.textContent=Math.ceil(a),c<1&&requestAnimationFrame(n)};requestAnimationFrame(n)})()})()}))})(100)})();